<% content_for(:breadcrumbs) do %>
<%= breadcrumbs do |b|
	b.item "Principal", root_path
    b.item "Clientes", clientes_path
    b.item @cliente.razonsocial, root_path, :active => true
end %>
<%end%>

<% content_for(:controls) do %>
<%= controls do |c|
    c.item "Exportar PDF", cliente_path( :format => 'pdf'), :icon => "report_go"
    c.item "Editar", edit_cliente_path(@cliente), :icon => "application_form_edit"
    c.item "Volver", clientes_path, :icon => "application_go"
end %>
<%end%>

<%= render 'sidebar' %>

<%= semantic_attributes_for(@cliente, options = {:class => :column_right}) do |attr| %>
  <%= attr.attributes do %>
	  <%= attr.attribute :razonsocial %>
	  <%= attr.attribute :fantasyname %>
	  <%= attr.attribute :cuit %>
   	<%= attr.attribute :telefono %>
   	<%= attr.attribute :direccion %>
   	<%= attr.attribute :localidad %>
   	<%= attr.attribute :province_id, :display_empty => true, :value => @cliente.province.try('name') %>
   	<%= attr.attribute :codigopostal %>
   	<%= attr.attribute :email %>
  	<%= attr.attribute :contacto %>
  	<%= attr.attribute :envelope, :value => (@cliente.envelope) ? 'Si' : 'No' %>
  	<%= attr.attribute :date_and_time_attention %>
   	<%= attr.attribute :condicioniva_id, :display_empty => true, :value => @cliente.condicioniva.try('detalle') %>
   	<%= attr.attribute :account_id, :display_empty => true, :value => @cliente.account.try('name') %>
   	<%= attr.attribute :observation %>
  <% end %>
<% end %>

<hr class="clear">
<p>
  <b>Facturas</b>
</p>
<table class="table">
 <tr>
    <th>Numero</th>
    <th>Fecha</th>
    <th>Importe</th>
    <th>Fecha Vto</th>
    <th></th>
    <th></th>
  </tr>
<% @cliente.facturas.each do |cpbte| %>
  <tr>
    <td class="last"><%= format("%04d" % cpbte.sale_point).to_s + '-' + format("%08d" % cpbte.numero).to_s %></td>
    <td><%= cpbte.fecha %></td>
    <td class="last"><%= format("%.2f" % cpbte.importe).to_s %></td>
    <td><%= cpbte.fechavto %></td>
    <td><%= link_to icon('application_go', :small, :title => 'ver'), [cpbte.cliente, cpbte] %></td>
    <td><%= link_to icon('printer', :small, :title => 'Imprimir'), cliente_factura_path(cpbte.cliente, cpbte, :format => 'pdf') %></td>
  </tr>
	<% cpbte.facturarecibos.each do |cpbteafectado| %>
  		<tr>
    		<td>recibo -------></td>
    		<td><%= cpbteafectado.fecha %></td>
    		<td class="last"><%= format("%.2f" % cpbteafectado.importe).to_s %></td>
        <td class="last"><%= format("%04d" % cpbteafectado.recibo.sale_point).to_s + '-' + format("%08d" % cpbteafectado.recibo.numero).to_s %></td>
	  		<td class="last"><%= format("%.2f" % cpbteafectado.recibo.importe).to_s %></td>
  		</tr>
	<% end %>
	
	<% cpbte.facturanotacreditos.each do |cpbteafectado| %>
		<tr>
  		<td>nota credito --></td>
  		<td><%= cpbteafectado.fecha %></td>
  		<td class="last"><%= format("%.2f" % cpbteafectado.importe).to_s %></td>
      <td class="last"><%= format("%04d" % cpbteafectado.factura.sale_point).to_s +'-'+format("%08d" % cpbteafectado.factura.numero).to_s %></td>
  		<td class="last"><%= format("%.2f" % cpbteafectado.factura.importe).to_s %></td>
		</tr>
	<% end %>	
<% end %>
</table>

<hr class="clear">
<p>
  <b>Recibos</b>
</p>
<table class="table">
 <tr>
    <th>Numero</th>
    <th>Fecha</th>
    <th>Importe</th>
    <th>Fecha Vto</th>
    <th></th>
    <th></th>
  </tr>

<% @cliente.recibos.each do |cpbte| %>
  <tr>
    <td class="last"><%= format("%04d" % cpbte.sale_point).to_s + '-' + format("%08d" % cpbte.numero).to_s %></td>
    <td><%= cpbte.fecha %></td>
		<td class="last"><%= format("%.2f" % cpbte.importe).to_s %></td>
    <td><%= cpbte.fechavto %></td>
    <td><%= link_to icon('application_go', :small, :title => 'ver'), [cpbte.cliente, cpbte] %></td>
    <td><%= link_to icon('printer', :small, :title => 'Imprimir'), cliente_recibo_path(cpbte.cliente, cpbte, :format => 'pdf') %></td>
  </tr>
	<% cpbte.facturarecibos.each do |cpbteafectado| %>
		<tr>
  		<td>factura -------></td>
  		<td><%= cpbteafectado.fecha %></td>
  		<td class="last"><%= format("%.2f" % cpbteafectado.importe).to_s %></td>
	    <td class="last"><%= format("%04d" % cpbteafectado.factura.sale_point).to_s + '-' + format("%08d" % cpbteafectado.factura.numero).to_s %></td>
  		<td><%= format("%.2f" % cpbteafectado.factura.importe).to_s %></td>
		</tr>
	<% end %>	
<% end %>
</table>

<hr class="clear">
<p>
  <b>Nota de credito</b>
</p>
<table class="table">
 <tr>
    <th>Numero</th>
    <th>Fecha</th>
    <th>Importe</th>
    <th>Fecha Vto</th>
    <th></th>
    <th></th>
  </tr>
<% @cliente.notacreditos.each do |cpbte| %>
  <tr>
    <td class="last"><%= format("%04d" % cpbte.sale_point).to_s + '-' + format("%08d" % cpbte.numero).to_s %></td>
    <td><%= cpbte.fecha %></td>
		<td class="last"><%= format("%.2f" % cpbte.importe).to_s %></td>
    <td><%= cpbte.fechavto %></td>
    <td><%= link_to icon('application_go', :small, :title => 'ver'), [cpbte.cliente, cpbte] %></td>
    <td><%= link_to icon('printer', :small, :title => 'Imprimir'), cliente_notacredito_path(cpbte.cliente, cpbte, :format => 'pdf') %></td>
  </tr>
	<% cpbte.facturanotacreditos.each do |cpbteafectado| %>
		<tr>
		  <td>factura -------></td>
		  <td><%= cpbteafectado.fecha %></td>
		  <td class="last"><%= format("%.2f" % cpbteafectado.importe).to_s %></td>
	    <td class="last"><%= format("%04d" % cpbteafectado.factura.sale_point).to_s + '-' + format("%08d" % cpbteafectado.factura.numero).to_s %></td>
  		<td><%= format("%.2f" % cpbteafectado.factura.importe).to_s %></td>
		</tr>
	<% end %>
<% end %>
</table>